<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Joki Makalah</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Panggil CSS -->
    <link rel="stylesheet" href="makalah.css">
</head>
<body>

<div class="form-container">
    <h2>üìÑ Joki Makalah</h2>

    <label>Nama</label>
    <input type="text" id="nama" required>

    <label>NIRM</label>
    <input type="text" id="nirm" required>

    <label>Program Studi</label>
    <input type="text" id="prodi" required>

    <label>Fakultas</label>
    <input type="text" id="fakultas" required>

    <label>Nama Kampus</label>
    <input type="text" id="kampus" required>

    <label>Judul Makalah <small>(Opsional)</small></label>
    <input type="text" id="judul">

    <label>Harga Makalah</label>
    <input type="text" id="harga" value="Rp 100.000" readonly>

    <label>Kode Voucher <small>(Opsional)</small></label>
    <input type="text" id="voucher" placeholder="Contoh: DISKON20">
    <div class="note">*Masukkan kode voucher jika tersedia</div>

    <button class="btn" onclick="beliSekarang()">Beli Sekarang</button>
</div>

<script>
const hargaAwal = 100000;

const voucher5 = [
    "HEMAT5A","HEMAT5B","HEMAT5C","HEMAT5D","HEMAT5E",
    "HEMAT5F","HEMAT5G","HEMAT5H","HEMAT5I","HEMAT5J"
];

const voucher10 = [
    "HEMAT10A","HEMAT10B","HEMAT10C","HEMAT10D","HEMAT10E",
    "HEMAT10F","HEMAT10G","HEMAT10H","HEMAT10I","HEMAT10J"
];

const voucher15 = [
    "HEMAT15A","HEMAT15B","HEMAT15C","HEMAT15D","HEMAT15E",
    "HEMAT15F","HEMAT15G","HEMAT15H","HEMAT15I","HEMAT15J"
];

let diskon = 0;
let voucherAktif = "HEMAT15B";

function cekVoucher() {
    const voucherInput = document.getElementById("voucher").value.toUpperCase();
    const info = document.getElementById("voucher-info");
    const inputHarga = document.getElementById("harga");

    diskon = 0;
    voucherAktif = "";

    if (voucherInput === "") {
        inputHarga.value = "Rp 100.000";
        info.innerHTML = "";
        return;
    }

    // cek apakah voucher sudah dipakai
    if (localStorage.getItem("voucher_" + voucherInput)) {
        info.innerHTML = "‚ùå Voucher sudah digunakan";
        inputHarga.value = "Rp 100.000";
        return;
    }

    if (voucher5.includes(voucherInput)) {
        diskon = 5;
    } else if (voucher10.includes(voucherInput)) {
        diskon = 10;
    } else if (voucher15.includes(voucherInput)) {
        diskon = 15;
    } else {
        info.innerHTML = "‚ùå Voucher tidak terdaftar";
        inputHarga.value = "Rp 100.000";
        return;
    }

    voucherAktif = voucherInput;
    const hargaAkhir = hargaAwal - (hargaAwal * diskon / 100);
    inputHarga.value = "Rp " + hargaAkhir.toLocaleString("id-ID");
    info.innerHTML = "‚úîÔ∏è Voucher valid! Diskon " + diskon + "%";
}

function semuaFormTerisi() {
    const wajib = ["nama","nirm","prodi","fakultas","kampus"];
    return wajib.every(id => document.getElementById(id).value.trim() !== "");
}

function beliSekarang() {

    if (!semuaFormTerisi()) {
        alert("‚ö†Ô∏è Mohon lengkapi semua data terlebih dahulu.");
        return;
    }

    const nama = document.getElementById("nama").value;
    const nirm = document.getElementById("nirm").value;
    const prodi = document.getElementById("prodi").value;
    const fakultas = document.getElementById("fakultas").value;
    const kampus = document.getElementById("kampus").value;
    const judul = document.getElementById("judul").value || "-";

    const totalBayar = hargaAwal - (hargaAwal * diskon / 100);

    // tandai voucher sudah dipakai
    if (voucherAktif !== "") {
        localStorage.setItem("voucher_" + voucherAktif, "used");
    }

    const pesan = `
*JOKI MAKALAH*
-----------------------
Nama: ${nama}
NIRM: ${nirm}
Program Studi: ${prodi}
Fakultas: ${fakultas}
Kampus: ${kampus}
Judul Makalah: ${judul}
Voucher: ${voucherAktif || "-"}
Diskon: ${diskon}%
Total Bayar: Rp ${totalBayar.toLocaleString("id-ID")}
-----------------------
Saya ingin lanjut pemesanan.
    `;

    const nomorAdmin = "6288245742094";
    const url = "https://wa.me/" + nomorAdmin + "?text=" + encodeURIComponent(pesan);
    window.open(url, "_blank");
}
</script>
